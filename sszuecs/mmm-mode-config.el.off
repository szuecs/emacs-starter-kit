(add-to-list 'load-path "~/emacs-libs/mmm-mode-0.4.8")
;(add-to-list 'load-path (concat my-libs-dir "mmm-mode-0.4.8"))

;; Interchange
(autoload 'css-mode "css-mode")
(add-to-list 'auto-mode-alist '("\\.css\\'" . css-mode))
(setq cssm-indent-function #'cssm-c-style-indenter)
(setq cssm-indent-level '2)

(require 'mmm-mode)
(setq mmm-global-mode 'maybe)

;; eschulte org mmm experiment
(mmm-add-classes
 '((embedded-org-css
    :submode css
    :face mmm-declaration-submode-face
    :delimiter-mode nil
    :front "#\\+begin_src css"
    :back "#\\+end_src")
   (embedded-org-emacs-lisp
    :submode emacs-lisp
    :face mmm-declaration-submode-face
    :delimiter-mode nil
    :front "#\\+begin_src emacs-lisp[^\n]*"
    :back "#\\+end_src")
   (embedded-org-ruby
    :submode ruby
    :face mmm-declaration-submode-face
    :delimiter-mode nil
    :front "#\\+begin_src ruby"
    :back "#\\+end_src")))
(mmm-add-mode-ext-class 'org-mode nil 'embedded-org-css)
(mmm-add-mode-ext-class 'org-mode nil 'embedded-org-emacs-lisp)
(mmm-add-mode-ext-class 'org-mode nil 'embedded-org-ruby)


;; perl stuff IIRC from mmm-mode page
(mmm-add-group
 'interchange
 '(
   (itl-perl
	:submode cperl-mode
	:face mmm-code-submode-face
	:front "\\\[perl.*?\\\]"
	:back "\\\[/perl\\\]")
   
   (itl-calc
	:submode cperl-mode
	:face mmm-code-submode-face
	:front "\\\[calc\\\]"
	:back "\\\[/calc\\\]")
   (itl-heredoc
	:submode cperl-mode
	:face mmm-code-submode-face
	:front "<<\\([a-zA-Z0-9_-]+\\)"
    :back "^~1$"
	:save-matches 1
   )))

(add-to-list 'mmm-mode-ext-classes-alist '(nxml-mode nil embedded-css))
(add-to-list 'mmm-mode-ext-classes-alist '(nxml-mode nil html-js))
(add-to-list 'mmm-mode-ext-classes-alist '(nxml-mode nil interchange))
;;;(add-to-list 'mmm-mode-ext-classes-alist '(nxml-mode nil mason))
(add-to-list 'mmm-mode-ext-classes-alist '(fundamental-mode nil interchange))

;; Javascript
;;(add-to-list 'mmm-mode-ext-classes-alist '(nxml-mode nil javascript))

;;; see ruby-conf.el for html/erb mmm-mode config
